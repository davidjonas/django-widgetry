django-widgetry
===============
Widget oriented layout for Django. Templating the way programmers like it... At least I do!!
This document aims at giving you an introdutory overview of how Widgetry was thought. The best way to learn how to use
it is to have a look at its code since it is very simple and all concentrated in one file (html_generator.py)

pydoc automatically generated HTML documentation is available on the doc folder.

Concept
=======
This module should not be seen as a replacement for Django's templating language
but as a set of tools that provide an alternative way to organize your view code.
I found the organization of the templating engine in Django, as most others,
not really confortable in situations where the templates are made by the programmers
instead of the designers.

Specially if you work with many different technologies, it is very hard to remember and update so many
different templating language syntaxes and rules. It should be as simple as: "I'm coding python so I template in python."

Widgetry allows you to code your templates in python, with full freedom and access to your methods and data,
using the concepts that you as programmers are used to, like class inheritance, conditions and loops
without special syntaxes.

The architecture is focused on creating really dynamic and modular pages and deal with management of resources needed to render
each specific page.

Installation
============

1 - Clone this repository into your Django project with the name widgetry (not django-widgetry):
```
cd [my_django_project_path]
git clone [this_rep] widgetry
```

2 - Add 'widgetry' to your settings.py under INSTALLED_APPS 

Resource dependency
===================
Widgetry introduces also the neat concept of CSS, javascript and head directive and resource dependencies. That means that
for each rendering of a page you will only link to the css and js files that you strictly need to render the current page.
Each widget on the page can require for it's specific resources and what order they should be included. Everything else
is taken care of by the widgetry rendering engine.

Compatibility with Django templates
===================================
The final result of any HTML rendering in Widgetry is passed through Django's templating engine before outputting. This
means that you can add any templating tags to you Widgets, Pages or Templates and they will work as you expect them to.
To activate this functionality you have to pass the request as argument to your Page.

Classes
=======
There are three main concepts to widgetry, they are all classes that are supposed to be subclassed within your project:

Page
----
This is the base class. It's the class that renders your HTML. Subclass it to create your "Main page" that defines
your base HTML structure, doctypes, javascripts and CSS that you use on all pages, metadata tags etc...
Normally you would have one or two of these classes.

Template
--------
This is the base class to all your content templates. It requires a "parent" Page and renders part of it's body directly or
through Widgets.
A Template subclass can require its own resources although optimally this should be done by each Widget.

Widget
------
Subclasses of Widget are the units of content. The idea is that you subclass a Widget, instanciate it with whatever data you need,
define its dependencies and add it to a template to be rendered

Usage
=====
Basically, to render a response you should have at least a subclass of a Page, a Template and as many Widgets as you want.
- Initialize your Template with your Page as "parent_page".
- Use the add() method on your Widgets to sequencially add HTML strings or addWidget() to add other widgets to be rendered.
- Use the same method to add Widgets to your template.
- When you are done. Call the render() method on the page to output the final HTML and send it through the response. 

Hierarchy
=========
This is a visual representation of an example hierarchy of an HTML document generated by Widgetry

```
Page ==> Django templating engine ==> HTML ==> Client browser
    |_ Template
        |_ Widget
            |_ "<tags>whatever</tags>"
        |_ Widget
            |_ "<tags>whatever</tags>"
        |_ "<tags>whatever</tags>"
        |_ Widget
            |_ Widget
            |_ Widget
            ...
        ...
```

Example
=======
A quick simple example. On your django app...

views.py
--------
```python

def about(request):
    """
    About page, it is called in /about
    """
    template = AboutTemplate(MainPage(request, "Hello world"))
    return HttpResponse(template.render())

```

templates.py
------------
```python

from my_django.widgetry.html_generator import Page, Template

class MainPage(Page):
    def __init__(self, request, title):
        super(MainPage, self).__init__(title, request=request)
        
        #This is not necessary, it defaults to html5
        self.setDocType('<!DOCTYPE html>')
        
        self.addJSFile("/static/example/js/jquery-1.6.2.min.js")
        self.content = '<h1>Hello world!</h1>'
        

class AboutTemplate(Template):
    def __init__(self, parent, iAmLazy=False):
        super(AboutTemplate, self).__init__(parent)
        
        menuItems = [
	            {"name":"Example", "link":"/example"},
	            {"name":"Google", "link":"http://www.google.com"},
	        ]
        
        self.addWidget(Menu(menuItems))
        
        if iAmLazy:
            self.add('<div class="message">')  
            self.add('You can also add just HTML directly if you are lazy.')
            self.add('</div>')
```

widgets.py
----------
```python

from my_django.widgetry.html_generator import Widget

class Menu(Widget):
    """
    Main Menu
    """
    def __init__(self, items):
        self.name = "menu"
        itemStructure = ""
        
        self.requireCSSFile("/static/menu.css")
        
        for item in items:
            itemStructure = itemStructure + '<li><a href="%(link)s">%(name)s</a></li>'%item
        
        self.add("<ul>%s</ul>"%itemStructure)
        
```






